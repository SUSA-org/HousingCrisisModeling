colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
tables[[i]] <- data
}
View(tables[1])
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
tables[[i]] <- data
}
View(tables[1])
df <- readRDS("RDS/CleanedACSDataframes.rds")
a <- df[[1]]
View(a[[1]])
View(a[[2]])
a <- df[[2]]
View(a[[1]])
View(a[[2]])
a <- df[[3]]
View(a[[1]])
View(rentalprice)
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (ind != -1) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(j*12+7)])))
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
View(data)
tables <- list()
num_cols = 15
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (ind != -1) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(j*12+7)])))
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
min(2,3)
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (ind != -1) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(min(100,(j*12+7)))])))
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (length(ind) != 0) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(min(100,(j*12+7)))])))
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
View(tables[1])
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (length(ind) != 0) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(min(100,(j*12+7)))]), na.rm=TRUE))
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
View(tables[1])
for (i in 1:58) {
data <- data.frame(matrix(ncol = num_cols, nrow = 28))
countyname = countynames[i]
colnames(data)[1] <- "Year"
data$Year <- 1990:2017
colnames(data)[2] <- "Building Permits"
data[12:28,2] <- clean.numeric(buildingpermits[i,2:18])
colnames(data)[3] <- "Median Income"
data[7:26, 3] <- clean.numeric(subset(medinc, County == countyname)[,5])
colnames(data)[4] <- "Median Home Price"
ind <- which(colnames(medhome) == countyname)
if (length(ind) != 0) {
v <- medhome[,ind]
v[is.nan(v)] <- NA
data[1:28,4] <- v
}
colnames(data)[5:7] <- c("Total Housing Units", "Vacancy Rate", "Persons per Household")
data[21:28,5:7] <- subset(housingUnits,County==countyname)[,c(5,12,13)]
colnames(data)[8] <- c("Population Density")
data[21:28,8] <- clean.numeric(popdens[i,2:9])
colnames(data)[9] <- c("Passenger Fares")
ind <- which(fares$County == countyname)
data[14:26,9] <- clean.numeric(fares[ind,2:14])
colnames(data)[10] <- c("Vehicle Inventory")
ind <- which(inventory$County == countyname)
if (length(ind) != 0) {
data[14:26,10] <- clean.numeric(inventory[ind,2:14])
}
colnames(data)[11] <- c("Vehicle Miles")
ind <- which(miles$`Transit Organization` == countyname)
if (length(ind) != 0) {
data[14:26,11] <- clean.numeric(miles[ind,2:14])
}
colnames(data)[12] <- c("Vehicle Hours")
ind <- which(hours$County == countyname)
if (length(ind) != 0) {
data[14:26,12] <- clean.numeric(hours[ind,2:14])
}
colnames(data)[13] <- c("HAI")
ind <- which(colnames(hai)==countyname)
if (length(ind) != 0) {
v <- hai[,ind]
v[is.nan(v)] <- NA
data[2:28,13] <- v
}
colnames(data)[14] <- c("Unemployment")
newunemployment <- c()
countyunemployment <- subset(unemployment, grepl(countyname,`Area Name`))
f <- function(x) as.numeric(gsub("[,\\$%]","",x))
for (j in 1:(336/12)) {
newunemployment <- c(newunemployment, mean(sapply(countyunemployment[(12*(j-1)+1):(12*j),11],f), na.rm=TRUE))
}
data[,14] <- newunemployment
colnames(data)[15] <- c("Rental Price")
ind <- which(rentalprice$RegionName == countyname)
if (length(ind) != 0) {
newrents <- c()
for (j in 1:8) {
newrents <- c(newrents, mean(clean.numeric(rentalprice[ind, ((j-1)*12+7):(min(100,(j*12+7)))]), na.rm=TRUE))
newrents[is.nan(newrents)] <- NA
}
data[21:28, 15] <- newrents
}
tables[[i]] <- data
}
View(tables[1])
counts <- cbind(tables[[1]])
counts[TRUE] <- 0
for (i in 1:length(tables)) {
for (j in 1:length(tables[[1]][,1])) {
for (k in 1:length(tables[[1]][1,])) {
if (!is.na(tables[[i]][j,k])) {
counts[j,k] <- counts[j,k] + 1
}
}
}
}
counts <- cbind(tables[[1]])
counts[TRUE] <- 0
counts[,1] <- 1990:2017
for (i in 1:length(tables)) {
for (j in 1:length(tables[[1]][,1])) {
for (k in 2:length(tables[[1]][1,])) {
if (!is.na(tables[[i]][j,k])) {
counts[j,k] <- counts[j,k] + 1
}
}
}
}
View(counts)
df <- readRDS("data-collection/cleaned-data/Tidy ACS Data (2011-2016)")
View(df)
uniques(subset(df, grepl("County", Geography))[,1])
unique(subset(df, grepl("County", Geography))[,1])
unique(df$Statistic)
View(subset(df, Statistic==""))
unique(df$`Statistic Description`)
